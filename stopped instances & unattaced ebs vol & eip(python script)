pre -req:
ubuntu server setup:
iam access aws configure 

apt update
 apt install jq -y
 apt install python3-pip
 pip3 --version
 pip3 install boto3
If you see the PEP 668 warning:
"You are attempting to install a package into a system Python environment which is protected..."

That’s because newer Debian/Ubuntu protect system Python by default.

✅ Safe way: Use virtual environment
1️⃣ Create a virtual environment:

bash
Copy
Edit
python3 -m venv myenv
2️⃣ Activate it:

bash
Copy
Edit
source myenv/bin/activate
3️⃣ Now install boto3:

bash
Copy
Edit
pip install boto3
This way, you don’t modify system Python — everything stays clean.
root@ip-192-168-2-44:~# cat cost.py
import boto3

ec2 = boto3.client('ec2', region_name='us-east-1')

# Delete stopped instances
instances = ec2.describe_instances(
    Filters=[{'Name': 'instance-state-name', 'Values': ['stopped']}]
)

for reservation in instances['Reservations']:
    for instance in reservation['Instances']:
        instance_id = instance['InstanceId']
        print(f"Terminating instance: {instance_id}")
        ec2.terminate_instances(InstanceIds=[instance_id])

# Delete available volumes
volumes = ec2.describe_volumes(
    Filters=[{'Name': 'status', 'Values': ['available']}]
)

for volume in volumes['Volumes']:
    volume_id = volume['VolumeId']
    print(f"Deleting volume: {volume_id}")
    ec2.delete_volume(VolumeId=volume_id)
# Release unattached Elastic IPs
addresses = ec2.describe_addresses()

for address in addresses['Addresses']:
    if 'InstanceId' not in address or address['InstanceId'] is None:
        allocation_id = address['AllocationId']
        print(f"Releasing unattached Elastic IP: {allocation_id}")
        ec2.release_address(AllocationId=allocation_id)
